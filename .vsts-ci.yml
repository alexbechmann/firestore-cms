queue:
  name: Hosted VS2017
  demands: npm

trigger:
- master
- release
- develop

steps:
- task: gittools.gitversion.gitversion-task.GitVersion@3

- task: Npm@1
  inputs:
    command: "install"
    verbose: "false"
    workingDir: "core"

- task: Npm@1
  inputs:
    command: "custom"
    verbose: "false"
    customCommand: "run build"
    workingDir: "core"

- task: PowerShell@1
  inputs:
    scriptName: "update-package-version.ps1"
    arguments: "$(GitVersion.SemVer)"
    workingFolder: "core"

- task: Npm@1
  inputs:
    command: "install"
    verbose: "false"
    workingDir: "functions"

- task: Npm@1
  inputs:
    command: "custom"
    verbose: "false"
    customCommand: "run build"
    workingDir: "functions"

- task: PowerShell@1
  inputs:
    scriptName: "update-package-version.ps1"
    arguments: "$(GitVersion.SemVer)"
    workingFolder: "functions"


